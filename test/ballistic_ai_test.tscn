[gd_scene load_steps=6 format=3 uid="uid://btpycjnfryp5p"]

[ext_resource type="Script" path="res://test/grid.gd" id="1_yysna"]
[ext_resource type="Texture2D" uid="uid://bude4na0hnosm" path="res://icon.svg" id="2_krx02"]
[ext_resource type="Script" path="res://classes/BallisticAI.gd" id="3_v44xm"]

[sub_resource type="GDScript" id="GDScript_l4cjt"]
script/source = "extends Node2D

var velocity:Vector2

# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	pass # Replace with function body.


# Called every frame. 'delta' is the elapsed time since the previous frame.
func _physics_process(delta: float) -> void:
	var to_target:Vector2 = get_global_mouse_position() - global_position
	velocity = to_target
	global_position += velocity * delta
"

[sub_resource type="GDScript" id="GDScript_t1mk0"]
script/source = "extends Node2D

var linear_velocity:Vector2
var angular_velocity:float

func _ready()->void:
	if($'../Actor'!=self):
		remove_child($BallisticAI)
		var newai:BoatAI = $'../Actor/BallisticAI'.duplicate()
		add_child(newai)

func _physics_process(delta: float) -> void:
	
	$BallisticAI.linear_velocity = linear_velocity
	$BallisticAI.angular_velocity = angular_velocity
	$BallisticAI.target_position = $'../Target'.global_position
	$BallisticAI.target_velocity = $'../Target'.velocity
		
	linear_velocity += $BallisticAI.force * delta
	angular_velocity += $BallisticAI.torque * delta
	
	global_position += linear_velocity * delta
	global_rotation += angular_velocity * delta
"

[node name="BallisticAiTest" type="Node2D"]

[node name="Grid" type="Node2D" parent="."]
script = ExtResource("1_yysna")
color = Color(0.458405, 0.458405, 0.458405, 1)
thickness = 1.0
separation = 128.0

[node name="Target" type="Node2D" parent="."]
script = SubResource("GDScript_l4cjt")

[node name="Sprite2D" type="Sprite2D" parent="Target"]
scale = Vector2(0.25, 0.25)
texture = ExtResource("2_krx02")

[node name="Camera2D" type="Camera2D" parent="Target"]
process_callback = 0

[node name="Actor" type="Node2D" parent="."]
position = Vector2(233, 223)
script = SubResource("GDScript_t1mk0")

[node name="Polygon2D" type="Polygon2D" parent="Actor"]
color = Color(1, 0.67451, 0.329412, 1)
polygon = PackedVector2Array(-12, 8, 0, -12, 12, 8)

[node name="BallisticAI" type="Node2D" parent="Actor"]
script = ExtResource("3_v44xm")
