[gd_scene load_steps=6 format=3 uid="uid://d0jk1v25t23vv"]

[ext_resource type="Theme" uid="uid://d0ifc4kse0sbj" path="res://ui/theme/theme.tres" id="1_q3c0r"]
[ext_resource type="Texture2D" uid="uid://eb8qdwstkm0d" path="res://ui/green_check.png" id="2_oww1r"]
[ext_resource type="Texture2D" uid="uid://ilsxdk1xejk2" path="res://ui/red_x.png" id="3_chgcx"]
[ext_resource type="Texture2D" uid="uid://dqjfimrkrf3lc" path="res://ui/loading.png" id="4_3yc8l"]

[sub_resource type="GDScript" id="GDScript_vvk8m"]
script/source = "@tool
extends PanelContainer

@export var rank:int:
	set(to):
		rank = to
		if(!is_inside_tree()):
			await tree_entered
		$HBoxContainer/Rank.text = str(rank)

@export var username:String:
	set(to):
		username = to
		if(!is_inside_tree()):
			await tree_entered
		$HBoxContainer/Name.text = username

@export var score:float:
	set(to):
		score = to
		if(!is_inside_tree()):
			await tree_entered
		$HBoxContainer/Score.text = '%d'%[score]

@export var time:int:
	set(to):
		time = to
		if(!is_inside_tree()):
			await tree_entered
		if(time>3600000):
			$HBoxContainer/Time.text = '%d:%02d:%02d'%[time/3600000, (time%3600000)/60000, (time%60000)/1000]
		else:
			$HBoxContainer/Time.text = '%d:%02d'%[time/60000, (time%60000)/1000]

@export var boss_kills:int:
	set(to):
		boss_kills = to
		if(!is_inside_tree()):
			await tree_entered
		$HBoxContainer/BossKills.text = str(boss_kills)

@export var submitted:bool:
	set(to):
		submitted=to
		if(!is_inside_tree()):
			await tree_entered
		$HBoxContainer/Submitted/No.visible = !submitted
		$HBoxContainer/Submitted/Yes.visible = submitted
		$HBoxContainer/Submitted/Control.hide()

@export var show_submitted:bool:
	set(to):
		show_submitted = to
		if(!is_inside_tree()):
			await tree_entered
		if(show_submitted):
			$HBoxContainer/VSeparator5.show()
			$HBoxContainer/Submitted.show()
		else:
			$HBoxContainer/VSeparator5.hide()
			$HBoxContainer/Submitted.hide()

var run_id:String


func _on_submit_button_pressed() -> void:
	
	$HBoxContainer/Submitted/No.hide()
	$HBoxContainer/Submitted/Yes.hide()
	$HBoxContainer/Submitted/Control.show()
	submitted = await GlobalMonitor.submit_run(run_id)
	
	pass # Replace with function body.

func _process(delta: float) -> void:
	if(!Engine.is_editor_hint() && $HBoxContainer/Submitted/Control.visible):
		$HBoxContainer/Submitted/Control/Control2.rotation += delta*2
"

[node name="LeaderboardEntry" type="PanelContainer"]
custom_minimum_size = Vector2(650, 0)
offset_left = -1.0
offset_right = 622.0
offset_bottom = 32.0
theme = ExtResource("1_q3c0r")
script = SubResource("GDScript_vvk8m")
rank = 1
username = "Anonymous"
score = 12345.0
time = 12345678
boss_kills = 13
show_submitted = true

[node name="HBoxContainer" type="HBoxContainer" parent="."]
layout_mode = 2

[node name="Rank" type="Label" parent="HBoxContainer"]
custom_minimum_size = Vector2(50, 0)
layout_mode = 2
text = "1"
horizontal_alignment = 1

[node name="VSeparator" type="VSeparator" parent="HBoxContainer"]
layout_mode = 2

[node name="Name" type="Label" parent="HBoxContainer"]
custom_minimum_size = Vector2(200, 24)
layout_mode = 2
size_flags_horizontal = 3
size_flags_stretch_ratio = 2.0
text = "Anonymous"
horizontal_alignment = 1

[node name="VSeparator2" type="VSeparator" parent="HBoxContainer"]
layout_mode = 2

[node name="Score" type="Label" parent="HBoxContainer"]
custom_minimum_size = Vector2(100, 0)
layout_mode = 2
size_flags_horizontal = 3
text = "12345"
horizontal_alignment = 1

[node name="VSeparator3" type="VSeparator" parent="HBoxContainer"]
layout_mode = 2

[node name="Time" type="Label" parent="HBoxContainer"]
custom_minimum_size = Vector2(100, 0)
layout_mode = 2
size_flags_horizontal = 3
text = "3:25:45"
horizontal_alignment = 1

[node name="VSeparator4" type="VSeparator" parent="HBoxContainer"]
layout_mode = 2

[node name="BossKills" type="Label" parent="HBoxContainer"]
custom_minimum_size = Vector2(100, 0)
layout_mode = 2
size_flags_horizontal = 3
text = "13"
horizontal_alignment = 1

[node name="VSeparator5" type="VSeparator" parent="HBoxContainer"]
layout_mode = 2

[node name="Submitted" type="AspectRatioContainer" parent="HBoxContainer"]
custom_minimum_size = Vector2(100, 0)
layout_mode = 2

[node name="Yes" type="TextureRect" parent="HBoxContainer/Submitted"]
visible = false
layout_mode = 2
texture = ExtResource("2_oww1r")
expand_mode = 1

[node name="No" type="TextureRect" parent="HBoxContainer/Submitted"]
layout_mode = 2
texture = ExtResource("3_chgcx")
expand_mode = 1

[node name="SubmitButton" type="Button" parent="HBoxContainer/Submitted/No"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
flat = true

[node name="Control" type="Control" parent="HBoxContainer/Submitted"]
layout_mode = 2

[node name="Control2" type="TextureRect" parent="HBoxContainer/Submitted/Control"]
modulate = Color(0.509286, 0.509286, 0.509286, 1)
texture_filter = 4
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(12, 12)
texture = ExtResource("4_3yc8l")
expand_mode = 1

[connection signal="pressed" from="HBoxContainer/Submitted/No/SubmitButton" to="." method="_on_submit_button_pressed"]
